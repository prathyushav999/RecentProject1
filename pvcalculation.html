<!DOCTYPE html>
<html lang="en">

<head>
<style>
.padding {
	height: 30px;
	border: 1px solid;
	padding-left: 10px;
	padding-right: 10px;
}

.centertd {
	height: 30px;
	border: 1px solid;
	text-align: center;
}
</style>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport"
	content="width=device-width, initial-scale=1.0,maximum-scale=1">
<meta name='viewport' content='width=device-width, initial-scale=1'>
<title>SREA Real Estates | Contact</title>

<!-- Loading third party fonts -->
<link
	href="http://fonts.googleapis.com/css?family=Roboto+Condensed:300,400|"
	rel="stylesheet" type="text/css">
<link href="fonts/font-awesome.min.css" rel="stylesheet" type="text/css">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<!-- Loading main css file -->
<link rel="stylesheet" href="style.css">
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src='https://kit.fontawesome.com/a076d05399.js'
	crossorigin='anonymous'></script>
<link rel="stylesheet" href="sideMenu.css">
</head>
<body>

	<div id="site-content" style="background-color: #000;">
		<div class="site-header">
			<div>
				<a href="" id="branding" style="height: 58px; width: 1300px;"> <img
					style="padding-left: 20px;" src="images/logo.png" alt=""
					class="logo">
					<div class="logo-text">
						<h1 class="site-title">SREA Real Estates</h1>
						<small class="site-description"><b>Where dreams come
								true.</b></small>

					</div>
					<div style="padding-top: 56px;">
						<a href="#" class="btn btn-info"> <span
							class="fa fa-power-off"></span> Log out
						</a>

					</div>
				</a>

			</div>
			<table>
				<tr style="background-color: #000;">
					<td><nav>
							<ul class="mcd-menu"
								style="position: relative; margin-bottom: 200%;">
								<!-- 			<li class="menu-item"><a href="about.html">About</a></li> -->
								<li><a onclick='treeChartWindow("chart")'> <i
										class="fa fa-street-view"></i> <strong>Orgization
											chart</strong> <small>Tree view</small>
								</a></li>
								<li><a onclick='treeChartWindow("payment")'>
										<i class="fa fa-money"></i> <strong>Payment</strong> <small>Payment Summary</small>
								</a></li>
								<li><a onclick='treeChartWindow("profile")'> <i
										class="fa fa-user-circle"></i> <strong>Profile</strong> <small>Your
											Details</small>
								</a></li>
								<li><a onclick='treeChartWindow("pv")' class="active" style="display:none;" id="pv"> <i
											class="fa fa-user-circle"></i> <strong>PV Calculation</strong> <small>Percentage division</small>
									</a></li>
							</ul>
						</nav></td>
					<td style="width: 100%; background-color: #eaeaea;">
						<div style="padding-top: 50px; padding-left: 20px;"id="calculate">
							<table>
								<tr>
									<td><label>Customer ID</label><br /> <input
										id="customerId" style="height: 35px; width: 300px;"></input>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
									<td><label>PV's</label><br /> <input id="pvs"
										style="height: 35px; width: 300px;"></input>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
									<td><label>Amount Per PV</label><br /> <input id="apv"
										style="height: 35px; width: 300px;"></input>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
									<td><br />
										<button style="height: 40px;" class="btn btn-info"
											onclick='show();'>Calculate</button></td>
											
								</tr>

							</table>
							<br /> <br />
							<table id="table1" style="display: none;">
								<tr>
									<td ><br /> <b>Customer Name
											&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
									<td id="customerName"><br />Hello123</td>
								</tr>

								<tr>
									<td  style="padding-top: 5px;"><b>Earned
											Pv's&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:</b></td>
									<td id="customerPvs">120</td>
								</tr>

								<tr>
									<td  style="padding-top: 5px;"><b>Earned
											Amount&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:</b></td>
									<td id="customerAmount">500</td>
								</tr>
							</table>
							<br /> <br />
							<div id="table2" style="display: none;">
								<table class="padding" style="width: 100%;">

									<thead>
										<tr >
											<th class="centertd">Sponser Name</th>
											<th class="centertd">Sponser Id</th>
											<th class="centertd">Level</th>
											<th class="centertd">Commision PV's</th>
											<th class="centertd">Commision Amount</th>
										</tr>
									</thead>
									<tbody>
										<tr id="tr7" hidden>
											<td class="padding" id="sponserName7">Salud Family Health Center</td>
											<td class="centertd" id="sponserId7">970-484-0999</td>
											<td class="padding" id="level7">220 E. Rogers Rd.</td>
											<td class="padding" id="pvs7">Longmont</td>
											<td class="padding" id="amount7">Longmont</td>
										</tr>
										<tr id="tr6" hidden>
											<td class="padding" id="sponserName6">Clinica Family Health Center</td>
											<td class="centertd" id="sponserId6">303-650-4460</td>
											<td class="padding" id="level6">1345 Plaza Court N.</td>
											<td class="padding" id="pvs6">Longmont</td>
											<td class="padding" id="amount6">Longmont</td>
										</tr>
										<tr id="tr5" hidden>
											<td class="padding" id="sponserName5">People's Medical Clinic</td>
											<td class="centertd" id="sponserId5">303-650-4460</td>
											<td class="padding"  id="level5">2525 13th St.</td>
											<td class="padding" id="pvs5">Longmont</td>
											<td class="padding" id="amount5">Longmont</td>
										</tr>
										<tr id="tr4" hidden>
											<td class="padding" id="sponserName4">Boulder Community Health</td>
											<td class="centertd" id="sponserId4">720-854-7000</td>
											<td class="padding" id="level4">4747 Arapahoe Ave.</td>
											<td class="padding" id="pvs4">Longmont</td>
											<td class="padding" id="amount4">Longmont</td>
										</tr>
										<tr id="tr3" hidden>
											<td class="padding" id="sponserName3">Avista Hospital</td>
											<td class="centertd" id="sponserId3">303-673-1000</td>
											<td class="padding" id="level3">100 Health Park Dr.</td>
											<td class="padding" id="pvs3">Longmont</td>
											<td class="padding" id="amount3">Longmont</td>
										</tr>
										<tr id="tr2" hidden>
											<td class="padding" id="sponserName2">Good Samaritan Medical Center</td>
											<td class="centertd" id="sponserId2">303-689-4000</td>
											<td class="padding" id="level2">200 Exempla Cr.</td>
											<td class="padding" id="pvs2">Longmont</td>
											<td class="padding" id="amount2">Longmont</td>
										</tr>
										<tr id="tr1" hidden>
											<td class="padding" id="sponserName1"></td>
											<td class="centertd" id="sponserId1"></td>
											<td class="padding" id="level1"></td>
											<td class="padding" id="pvs1">Longmont</td>
											<td class="padding" id="amount1">Longmont</td>
										</tr>
									

									</tbody>
								</table>
							</div>
							<div><h1 id="msg"></h1>
							</div>
							<br /> <br /> <br /> <br />
							<div style="margin-bottom: 5%; display: none;" id="submit">
								<center>
									<button class="btn btn-info" onclick="update();">submit</button>
								</center>
							</div>
						</div>

					</td>

				</tr>
			</table>
		</div>
	</div>
</body>
<script type="text/javascript">
	var queryString = new Array();
	var customerId = "";
	window.onload = function() {
		if (queryString.length == 0) {
			if (window.location.search.split('?').length > 1) {
				var params = window.location.search.split('?')[1].split('&');
				for (var i = 0; i < params.length; i++) {
					var key = params[i].split('=')[0];
					var value = decodeURIComponent(params[i].split('=')[1]);
					queryString[key] = value;
				}
			}
		}
		if (queryString["customerId"] != null) {
			customerId = queryString["customerId"];
			if (customerId == 'SREA-0') {
				document.getElementById("pv").style.display = "block";
			} 
			/* const url = "http://localhost/crud/template.html?customerId="
				+ customerId;
			window.location.href = url;
			return; */
		}
	};

	function treeChartWindow(screen) {
		if (queryString.length == 0) {
			if (window.location.search.split('?').length > 1) {
				var params = window.location.search.split('?')[1].split('&');
				for (var i = 0; i < params.length; i++) {
					var key = params[i].split('=')[0];
					var value = decodeURIComponent(params[i].split('=')[1]);
					queryString[key] = value;
				}
			}
		}
		if (queryString["customerId"] != null) {
			customerId = queryString["customerId"];
			const url = "";
			if (screen == "chart") {
				const url = "http://localhost/SREA/orgchart.html?customerId="
						+ customerId;
				window.location.href = url;
				return;
			}
			if (screen == "payment") {
				const url = "http://localhost/SREA/payment.php?customerId="
						+ customerId;
				window.location.href = url;
				return;
			}
			if (screen == "profile") {
				const url = "http://localhost/SREA/profile.html?customerId="
						+ customerId;
				window.location.href = url;
				return;
			}
			if (screen == "pv") {
				const url = "http://localhost/SREA/pvcalculation.html?customerId="
						+ customerId;
				window.location.href = url;
				return;
			}
		}
	}
	function show() {
		var customerId=document.getElementById("customerId").value;
		var pvs=parseInt(document.getElementById("pvs").value);
		var amountPerPv=parseInt(document.getElementById("apv").value);
		if(customerId.length==0)
			{
			alert("CustomerId should not be Empty");
			return;
			}

		if(!(typeof pvs === 'number' && isFinite(pvs)))
			{
			alert("PVS should have a number");
			return;
			}

		if(!(typeof amountPerPv === 'number' && isFinite(amountPerPv)))
			{
			alert("amountPerPv should have a number");
			return;
			}
		
		const xhttp = new XMLHttpRequest();
		  var res;
		  document.getElementById("tr7").setAttribute("hidden", true);
		  document.getElementById("tr6").setAttribute("hidden", true);
		  document.getElementById("tr5").setAttribute("hidden" , true);
		  document.getElementById("tr4").setAttribute("hidden" ,true);
		  document.getElementById("tr3").setAttribute("hidden" ,true);
		  document.getElementById("tr2").setAttribute("hidden", true);
		  document.getElementById("tr1").setAttribute("hidden", true);
		  
		  xhttp.onload = function() {
			 res=this.responseText;
			 document.getElementById("msg").innerHTML=res;
			 if(!(res.includes("<br>")))
			{
				 document.getElementById("msg").innerHTML="Unsuccessfull : "+res;
				 return;
		    }
			 res=res.split("<br>");
			 var tempres=res[0].split(" ");
			 document.getElementById("customerName").innerHTML="<br>"+tempres[0];
			 document.getElementById("customerPvs").innerHTML="<br>"+tempres[3];
			 document.getElementById("customerAmount").innerHTML="<br>"+tempres[4];
			 var count=1;
			 while(count<res.length-1)
				 {
				 tempres=res[count].split(" ");	 
				 document.getElementById("tr"+(8-count)).removeAttribute("hidden");
				 document.getElementById("sponserName"+(8-count)).innerHTML=tempres[0];
				 document.getElementById("sponserId"+(8-count)).innerHTML=tempres[1];
				 document.getElementById("level"+(8-count)).innerHTML=tempres[2];
				 document.getElementById("pvs"+(8-count)).innerHTML=tempres[3];
				 document.getElementById("amount"+(8-count)).innerHTML=tempres[4];
				 count+=1;
				 }
			 return ;
		  }
		  xhttp.open("POST", "showpvs.php");
		  xhttp.setRequestHeader("Content-Type", "application/json");
		  var data = {customerId:customerId,pvs:pvs,amountPerPv:amountPerPv};
		  xhttp.send(JSON.stringify(data));	  
			
		document.getElementById("table1").style.display = "block";
		document.getElementById("table2").style.display = "block";
		document.getElementById("submit").style.display = "block";
	}
	
	function update() {
		var customerId=document.getElementById("customerId").value;
		var pvs=parseInt(document.getElementById("pvs").value);
		var amountPerPv=parseInt(document.getElementById("apv").value);
		if(customerId.length==0)
			{
			alert("CustomerId should not be Empty");
			return;
			}

		if(!(typeof pvs === 'number' && isFinite(pvs)))
			{
			alert("PVS should have a number");
			return;
			}

		if(!(typeof amountPerPv === 'number' && isFinite(amountPerPv)))
			{
			alert("amountPerPv should have a number");
			return;
			}
		
		const xhttp = new XMLHttpRequest();
		  var res;
		  xhttp.onload = function() {
			 res=this.responseText;
			 if(!(res.includes("<br>")))
				{
					 document.getElementById("msg").innerHTML="Unsuccessfull : "+res;
					 return;
			    }
			 document.getElementById("msg").innerHTML="Success";

		  }
		  xhttp.open("POST", "updatepvs.php");
		  xhttp.setRequestHeader("Content-Type", "application/json");
		  var data = {customerId:customerId,pvs:pvs,amountPerPv:amountPerPv};
		  xhttp.send(JSON.stringify(data));	  
			
		  document.getElementById("table1").style.display = "none";
		  document.getElementById("table2").style.display = "none";
		  document.getElementById("submit").style.display = "none";
		  
	}

	function hide() {
		document.getElementById("table1").style.display = "none";
		document.getElementById("table2").style.display = "none";
		document.getElementById("submit").style.display = "none";
	}
</script>
</html>